<Window
    x:Class="ZlecajGoWpfApp.Views.CreateOfferWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="clr-namespace:ZlecajGoWpfApp.ViewModels"
    Width="500"
    Height="650"
    d:DataContext="{d:DesignInstance Type=viewModel:CreateOfferViewModel,
                                     IsDesignTimeCreatable=True}"
    AllowsTransparency="True"
    Background="Transparent"
    FontFamily="{DynamicResource MaterialDesignFont}"
    IsEnabled="{Binding IsNotBusy}"
    ResizeMode="NoResize"
    TextElement.FontSize="{StaticResource SmallFontSize}"
    TextElement.FontWeight="Regular"
    TextElement.Foreground="{DynamicResource MaterialDesignBody}"
    TextOptions.TextFormattingMode="Ideal"
    TextOptions.TextRenderingMode="Auto"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d">

    <Window.Resources>
        <DataTemplate x:Key="DurationInDaysTemplate">
            <TextBlock Text="{Binding Converter={StaticResource DurationInDaysConverter}}"/>
        </DataTemplate>
    </Window.Resources>

    <!--  The Card margin and the DropShadowEffect blur radius must have the same values  -->
    <materialDesign:Card
        Margin="20"
        Background="{StaticResource MaterialDesignPaper}">
        <materialDesign:Card.Effect>
            <DropShadowEffect
                BlurRadius="20"
                ShadowDepth="0"/>
        </materialDesign:Card.Effect>

        <Grid Margin="20,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width=".10*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height=".10*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height=".10*"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height=".10*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height=".10*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height=".10*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height=".10*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Label
                Grid.Row="0"
                Grid.Column="0"
                Grid.ColumnSpan="3"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Content="{Binding Title}"
                FontSize="{StaticResource BigFontSize}"
                FontWeight="Bold"/>
            <ComboBox
                Grid.Row="1"
                Grid.Column="0"
                materialDesign:HintAssist.Hint="Typ"
                materialDesign:HintAssist.IsFloating="True"
                DisplayMemberPath="Name"
                FontSize="{StaticResource RegularFontSize}"
                IsReadOnly="True"
                ItemsSource="{Binding OfferTypes}"
                SelectedItem="{Binding SelectedOfferType, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <ComboBox
                Grid.Row="1"
                Grid.Column="2"
                materialDesign:HintAssist.Hint="Kategoria"
                materialDesign:HintAssist.IsFloating="True"
                DisplayMemberPath="Name"
                FontSize="{StaticResource RegularFontSize}"
                IsReadOnly="True"
                ItemsSource="{Binding OfferCategories}"
                SelectedItem="{Binding SelectedOfferCategory, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox
                Grid.Row="3"
                Grid.Column="0"
                Grid.ColumnSpan="3"
                materialDesign:HintAssist.Hint="Tytuł"
                materialDesign:HintAssist.IsFloating="True"
                FontSize="{StaticResource RegularFontSize}"
                MaxLength="70"
                Text="{Binding OfferTitle, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox
                Grid.Row="5"
                Grid.Column="0"
                Grid.ColumnSpan="3"
                VerticalAlignment="Stretch"
                materialDesign:HintAssist.Hint="Opis"
                materialDesign:HintAssist.IsFloating="True"
                FontSize="{StaticResource RegularFontSize}"
                MaxLength="500"
                Text="{Binding OfferDescription, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"
                TextWrapping="Wrap"/>
            <TextBox
                Grid.Row="7"
                Grid.Column="0"
                materialDesign:HintAssist.Hint="Kod pocztowy (xx-xxx)"
                materialDesign:HintAssist.IsFloating="True"
                DataObject.Pasting="TextBox_OnPasting"
                FontSize="{StaticResource RegularFontSize}"
                LostFocus="PostalCodeTextBox_OnLostFocus"
                PreviewKeyDown="TextBox_OnPreviewKeyDown"
                PreviewTextInput="PostalCodeTextBox_OnPreviewTextInput"
                Text="{Binding PostalCode, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <ComboBox
                Grid.Row="7"
                Grid.Column="2"
                materialDesign:HintAssist.Hint="Miejscowość"
                materialDesign:HintAssist.IsFloating="True"
                FontSize="{StaticResource RegularFontSize}"
                IsEnabled="{Binding PlacesFound}"
                IsReadOnly="True"
                ItemsSource="{Binding PlacesView}"
                SelectedItem="{Binding SelectedPlace, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox
                Grid.Row="9"
                Grid.Column="0"
                materialDesign:HintAssist.Hint="Ulica"
                materialDesign:HintAssist.IsFloating="True"
                FontSize="{StaticResource RegularFontSize}"
                MaxLength="50"
                Text="{Binding StreetName, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox
                Grid.Row="9"
                Grid.Column="2"
                materialDesign:HintAssist.Hint="Numer"
                materialDesign:HintAssist.IsFloating="True"
                FontSize="{StaticResource RegularFontSize}"
                MaxLength="10"
                Text="{Binding StreetNumber, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <ComboBox
                Grid.Row="11"
                Grid.Column="0"
                materialDesign:HintAssist.Hint="Czas trwania ogłoszenia"
                materialDesign:HintAssist.IsFloating="True"
                FontSize="{StaticResource RegularFontSize}"
                IsReadOnly="True"
                ItemTemplate="{StaticResource DurationInDaysTemplate}"
                ItemsSource="{Binding DurationInDays}"
                SelectedItem="{Binding SelectedDurationInDays, ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged}"/>
            <TextBox
                Grid.Row="11"
                Grid.Column="2"
                materialDesign:HintAssist.Hint="Wynagrodzenie (zł)"
                materialDesign:HintAssist.IsFloating="True"
                DataObject.Pasting="TextBox_OnPasting"
                FontSize="{StaticResource RegularFontSize}"
                LostFocus="PriceTextBox_LostFocus"
                PreviewKeyDown="TextBox_OnPreviewKeyDown"
                PreviewTextInput="PriceTextBox_PreviewTextInput"
                Text="{Binding OfferPrice, UpdateSourceTrigger=PropertyChanged}"/>
            <Button
                Grid.Row="13"
                Grid.Column="0"
                Command="{Binding AddOfferCommand}"
                Content="Potwierdź"
                Visibility="{Binding IsNotBusy, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            <Button
                Grid.Row="13"
                Grid.Column="2"
                Background="{StaticResource MaterialDesignPaper}"
                BorderThickness="2"
                Command="{Binding CancelCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                Content="Anuluj"
                Foreground="Red"/>
            <Border
                Grid.Row="0"
                Grid.RowSpan="14"
                Grid.Column="0"
                Grid.ColumnSpan="3"
                Margin="-20,0"
                Background="{StaticResource MaterialDesignPaper}"
                Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}">
                <ProgressBar
                    Width="64"
                    Height="64"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    IsIndeterminate="True"
                    Style="{StaticResource MaterialDesignCircularProgressBar}"/>
            </Border>
        </Grid>
    </materialDesign:Card>

</Window>
